import{E as Z}from"./chunk-6XGMAUUD.js";import"./chunk-NODAZ5ET.js";import"./chunk-QUJFQN2Y.js";import"./chunk-U2EW7UUI.js";import"./chunk-3VGDWX6T.js";import"./chunk-TPX2NT44.js";import"./chunk-PESUVOSL.js";import{B as Y,c as A,i as G,j as O,k as J,l as K,q as Q,r as U,s as X}from"./chunk-H73HDHKZ.js";import{$ as h,D as x,Ea as W,F as I,G as o,H as i,J as T,K as y,M as b,N as M,O as m,V as S,W as d,_ as w,aa as _,ca as v,ia as P,j as C,nb as L,oa as E,ob as j,pb as q,q as c,qb as H,r as p,ra as V,rb as B,ua as k,va as R,xa as F,xb as D,y as u,yb as z,z as l,za as N}from"./chunk-Q3SEP6DO.js";import"./chunk-SC7NNYP7.js";import"./chunk-7KGURMOZ.js";import"./chunk-O2LKDVXV.js";import"./chunk-UVK64YLH.js";import"./chunk-6IHAYORV.js";import"./chunk-3OY46VXU.js";import"./chunk-BD6LD5VO.js";import"./chunk-MTHZ7MWU.js";import"./chunk-WI5MSH4N.js";import"./chunk-YP6DMM4G.js";import"./chunk-CKP3SGE2.js";import"./chunk-HS6F7JI3.js";import"./chunk-NQVRKVPL.js";import"./chunk-NTF5CPGF.js";import"./chunk-DLTAMAIO.js";import"./chunk-K6FI7DQH.js";import"./chunk-TLQMGTG2.js";import"./chunk-4WFVMWDK.js";import"./chunk-M2X7KQLB.js";import"./chunk-2YSZFPCQ.js";import"./chunk-57YRIO75.js";import"./chunk-LRFGNCHE.js";import"./chunk-C5RQ2IC2.js";import"./chunk-42C7ZIID.js";import{e as f}from"./chunk-FP7EQKGB.js";function $(r,a){if(r&1){let s=b();T(0),o(1,"form",3),M("ngSubmit",function(){c(s);let e=m();return p(e.cambiarPassword())}),o(2,"ion-item")(3,"ion-label",4),d(4,"Nueva contrase\xF1a"),i(),o(5,"ion-input",5),_("ngModelChange",function(e){c(s);let n=m();return h(n.password,e)||(n.password=e),p(e)}),i()(),o(6,"ion-item")(7,"ion-label",4),d(8,"Confirmar contrase\xF1a"),i(),o(9,"ion-input",6),_("ngModelChange",function(e){c(s);let n=m();return h(n.confirmpassword,e)||(n.confirmpassword=e),p(e)}),i()(),o(10,"ion-button",7),d(11," Cambiar contrase\xF1a "),i()(),y()}if(r&2){let s=m();u(5),w("ngModel",s.password),u(4),w("ngModel",s.confirmpassword)}}function ee(r,a){r&1&&(o(0,"ion-text",8)(1,"p",9),d(2,"El enlace no es v\xE1lido o ha expirado."),i()())}var he=(()=>{let a=class a{constructor(t,e,n,g){this.route=t,this.http=e,this.toast=n,this.router=g,this.password="",this.confirmpassword="",this.token="",this.tokenValido=!1}ngOnInit(){this.route.queryParamMap.subscribe(t=>{let e=t.get("token"),n=t.get("valid");if(!e||n!=="true"){this.presentToast("Token inv\xE1lido o expirado","danger"),this.router.navigate(["/login"]);return}this.token=e,this.tokenValido=!0})}cambiarPassword(){return f(this,null,function*(){if(!this.password||!this.confirmpassword)return this.presentToast("Todos los campos son obligatorios","warning");if(this.password!==this.confirmpassword)return this.presentToast("Las contrase\xF1as no coinciden","danger");try{let t=yield this.http.post(`https://travel-agency-backend-dn6i.onrender.com/travel/usuarios/recuperar-password/${this.token}`,{password:this.password,confirmpassword:this.confirmpassword}).toPromise();yield this.presentToast(t.msg,"success"),this.router.navigate(["/login"])}catch(t){yield this.presentToast(t.error?.msg||"Error al actualizar la contrase\xF1a","danger")}})}presentToast(t,e){return f(this,null,function*(){(yield this.toast.create({message:t,duration:3e3,color:e})).present()})}};a.\u0275fac=function(e){return new(e||a)(l(F),l(k),l(Z),l(N))},a.\u0275cmp=C({type:a,selectors:[["app-reset-password"]],standalone:!0,features:[v],decls:8,vars:2,consts:[["errorTemplate",""],[1,"ion-padding"],[4,"ngIf","ngIfElse"],[3,"ngSubmit"],["position","floating"],["type","password","name","password","required","",3,"ngModelChange","ngModel"],["type","password","name","confirmpassword","required","",3,"ngModelChange","ngModel"],["expand","block","type","submit",1,"ion-margin-top"],["color","danger"],[1,"ion-text-center"]],template:function(e,n){if(e&1&&(o(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),d(3,"Restablecer Contrase\xF1a"),i()()(),o(4,"ion-content",1),x(5,$,12,2,"ng-container",2)(6,ee,3,0,"ng-template",null,0,P),i()),e&2){let g=S(7);u(5),I("ngIf",n.tokenValido)("ngIfElse",g)}},dependencies:[G,O,U,X,Y,J,K,A,Q,V,E,z,B,L,j,D,H,q,R,W]});let r=a;return r})();export{he as ResetPasswordPage};
